---
layout: post
subtitle: 《操作系统》 14小节： 多处理器系统（MultiProcessor System,MPS）
tags: [操作系统]
comments: false
cover-img: /assets/img/IMG_1753.JPG
thumbnail-img: /assets/img/操作系统概论.jpeg
share-img: /assets/img/IMG_1482.JPG
---

 对处理器系统有多种不同的分类方式，根据处理器的耦合程度，可把处理器分为紧密耦合多处理器系统和松弛耦合处理器系统；根据处理器结构是否相同，可以把处理器分为对称多处理器系统和非对称处理系统。

# 操作系统

##  多处理器调度

### 紧密耦合的多处理器系统

紧密耦合的多处理器系统通常通过高速总线或高速交叉开关实现多个处理器直之间的互连，他们共享主存储器系统和I/O设备，并要求将主存器划分成若干独立访问的存储器模块，以便多个处理同时对主存进行访问。系统中所有资源都有操作系统实施统一的控制和管理。

### 松弛耦合的多处理器系统

松弛耦合的多处理器系统通常通过通道或者通信线路来实现多台计算机的互连。每台计算机都有自己的存储器和 I/O 设备，并配置了操作系统来管理本地资源和本地运行的进程。因此，每台计算机都能独立工作，必要时可通过通信线路与其他计算机交换信息，以及协调他们之间的工作。

### 对称多处理器系统

对称多处理器系统属于同构造多处理器系统，其包含的处理单元，功能，结构都相同。当前的绝大数的系统都是对称处理器系统。

#### 静态的进程分配

操作系统为每一个处理建立一个专门的就绪队列，该就绪队列的每个进程都只能在与就绪队列对应的处理器上运行，无论经过多少次调度，操作系统都会把同一个处理器分配给该进程。静态分配的优点是进程调度的开销小，缺点是不能动态的平衡各个处理器的负载，使系统存在各处理器忙闲不均的情况。

#### 动态的进程分配

动态分配的基本特征就是每个进程经过多次调度，每次获得的不一定是同一个处理器。为了实现动态分配，可在系统中设置一个公共就绪队列，系统中的所有进程都被放在该队列中。

### 非对称多处理器系统

非对称处理器系统中有多种类型的处理单元，他们的功能，结构，各不相同，其中只有一个主处理器，有多个从处理器。

#### 进程分配方式

对于非对称处理器系统，大多采用主-从式操作系统，即操作系统的核心部分驻留在一台机器上，而从机器只运行用户程序，只有主机执行调度程序，所有从机的进程都由主机分配的。每当从机空闲时，边向主机发送一个请求分配进程的信号，然后等待主机为它分配进程。主机维护一个就绪队列，只要队列不为空，主机便从队首获取进程分配给从机，从机接受到分配的进程后便运行改进程，改进程结束后又向主机发送请求。

在非对称多处理器中，主，从式的进程分配方式的优点是系统处理比较简单。


### 进程（线程）的调度方式

#### 自调度

采用自调度的系统中设置一个公共的就绪队列，任何一个空闲的处理器都可以自行从改队列中选取一个进程或一个线程运行。在自调度方式中可以采用单处理器环境下所用的调度算法，如FCFS，在多处理器环境下 FCFS是一种较好的调度算法，算法简单开销小。

##### 自调度的优点

- 容易移植
> 公共就绪队列可以按照单处理器所采用的各种组织方式加以组织，其调度算法也可沿用单处理器的系统所用算法，因此很容易将单处理器的调度基础一致到多处理器系统中。

- 有利于提高CPU的利用率
> 只要公共就绪队列不为空，就不会出现处理机空虚的情况。

##### 自调度的缺点

- 瓶颈问题
> 整个系统只有一个互斥访问的公共就绪队列。

- 低效率
> CPU 上的高速缓冲的命中率较低。

- 线程切换频繁
> 在多线程的相互合作的关系中，多个线程很难同时获得CPU，这会使某些线程因为合作线程没有运行而阻塞，进而被迫切换下来。

#### 成组调度

成组调度方式是由系统将一组相互合作的线程或进程同时分配到一组处理器上运行，进而进程和线程与处理器的关系一一对应。

##### 成组调度的优点

- 减少了线程切换，改善系统性能。
- 减少系统的开销。

##### 成组调度的时间分配

成组调度中采用两种方式为应用程序分配处理器时间：面向所有应用程序平均分配处理器时间；二是面向所有线程平均分配处理器时间。



